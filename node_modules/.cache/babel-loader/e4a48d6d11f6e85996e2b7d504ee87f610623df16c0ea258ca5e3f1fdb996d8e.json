{"ast":null,"code":"var _jsxFileName = \"/Users/amirkia/Documents/active-front/src/pages/onSite/variants/index.tsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport useGetProductVariants from './hooks/useGetProductVariants';\nimport CardItem from 'components/cards/product';\nimport Header from 'components/headers/main';\nimport Loading from 'components/loading';\nimport Footer from './footer';\nimport useSetCardItems from './hooks/useSetCardItems';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function ProductVariantsPage() {\n  _s();\n  const [cards, setCards] = useState();\n  const [selectedCards, setSelectedCards] = useState([]);\n  const {\n    data,\n    isLoading\n  } = useGetProductVariants();\n  const {\n    mutate,\n    isPending\n  } = useSetCardItems(setCards);\n  const [lastOfData, setLastOfData] = useState();\n  useEffect(() => {\n    if (data) {\n      setCards(data);\n      const newSelected = [];\n      data.items.map(item => newSelected.push({\n        ...item,\n        variants: []\n      }));\n      setSelectedCards(newSelected);\n    }\n  }, [data]);\n  const handleMutate = (base_uuid, payload, count) => {\n    const newSelctedCard = [];\n    selectedCards.map(item => {\n      if (item.base_uuid === base_uuid) {\n        const findVariant = item.variants.find(v => v.variant_uuid === payload.variant_uuid);\n        if (findVariant) {\n          const filterVariants = item.variants.filter(v => v.variant_uuid !== payload.variant_uuid);\n          newSelctedCard.push({\n            ...item,\n            variants: [...filterVariants, {\n              ...payload,\n              quantity: count\n            }]\n          });\n        } else {\n          newSelctedCard.push({\n            ...item,\n            variants: [...item.variants, {\n              ...payload,\n              quantity: count\n            }]\n          });\n        }\n      } else {\n        newSelctedCard.push(item);\n      }\n    });\n    setSelectedCards(newSelctedCard);\n    if (cards) {\n      const newData = {\n        total_duration: cards === null || cards === void 0 ? void 0 : cards.total_duration,\n        total_price: cards.total_price,\n        items: newSelctedCard\n      };\n      setLastOfData(newData);\n      mutate(newData);\n    }\n  };\n  const handleNewVariantMutate = (base_uuid, payload, squareCount) => {\n    const newSelctedCard = [];\n    selectedCards.map(item => {\n      if (item.base_uuid === base_uuid) {\n        console.log('item.new_variants', item);\n        if (item.new_variants) {\n          newSelctedCard.push({\n            ...item,\n            new_variants: [...item.new_variants, {\n              variant_quantity: squareCount,\n              quantity: payload\n            }]\n          });\n        } else {\n          newSelctedCard.push({\n            ...item,\n            new_variants: [{\n              variant_quantity: squareCount,\n              quantity: payload\n            }]\n          });\n        }\n      } else {\n        newSelctedCard.push(item);\n      }\n    });\n    setSelectedCards(newSelctedCard);\n    if (cards) {\n      const newData = {\n        total_duration: cards === null || cards === void 0 ? void 0 : cards.total_duration,\n        total_price: cards.total_price,\n        items: newSelctedCard\n      };\n      setLastOfData(newData);\n      mutate(newData);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: isLoading ? /*#__PURE__*/_jsxDEV(Loading, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 5\n    }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex flex-col h-full min-h-screen\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex-none w-full\",\n          children: /*#__PURE__*/_jsxDEV(Header, {\n            title: \"\\u062E\\u062F\\u0645\\u062A \\u062F\\u0631 \\u0645\\u062D\\u0644\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 122,\n            columnNumber: 8\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 7\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \" grow\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"grid grid-cols-1 gap-4 items-center justify-center my-2 mx-2\",\n            children: cards && cards.items.map(item => /*#__PURE__*/_jsxDEV(CardItem, {\n              item: item,\n              handleMutate: handleMutate,\n              handleNewVariantMutate: handleNewVariantMutate\n            }, item.base_uuid, false, {\n              fileName: _jsxFileName,\n              lineNumber: 128,\n              columnNumber: 11\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 125,\n            columnNumber: 8\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 124,\n          columnNumber: 7\n        }, this), cards && cards.total_duration && cards.total_price && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex-none\",\n          children: /*#__PURE__*/_jsxDEV(Footer, {\n            time: cards.total_duration,\n            price: cards.total_price,\n            data: lastOfData,\n            mutate: mutate\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 139,\n            columnNumber: 9\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 138,\n          columnNumber: 8\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 6\n      }, this)\n    }, void 0, false)\n  }, void 0, false);\n}\n_s(ProductVariantsPage, \"ulWWwutH0mfefugN7UuXrWmlxg8=\", false, function () {\n  return [useGetProductVariants, useSetCardItems];\n});\n_c = ProductVariantsPage;\nvar _c;\n$RefreshReg$(_c, \"ProductVariantsPage\");","map":{"version":3,"names":["React","useEffect","useState","useGetProductVariants","CardItem","Header","Loading","Footer","useSetCardItems","jsxDEV","_jsxDEV","Fragment","_Fragment","ProductVariantsPage","_s","cards","setCards","selectedCards","setSelectedCards","data","isLoading","mutate","isPending","lastOfData","setLastOfData","newSelected","items","map","item","push","variants","handleMutate","base_uuid","payload","count","newSelctedCard","findVariant","find","v","variant_uuid","filterVariants","filter","quantity","newData","total_duration","total_price","handleNewVariantMutate","squareCount","console","log","new_variants","variant_quantity","children","fileName","_jsxFileName","lineNumber","columnNumber","className","title","time","price","_c","$RefreshReg$"],"sources":["/Users/amirkia/Documents/active-front/src/pages/onSite/variants/index.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport useGetProductVariants from './hooks/useGetProductVariants';\nimport CardItem from 'components/cards/product';\nimport Header from 'components/headers/main';\nimport Loading from 'components/loading';\nimport Footer from './footer';\nimport useSetCardItems from './hooks/useSetCardItems';\nimport {\n\tIProductVariant,\n\tIProductVariantChild,\n\tIProductVariantChildToChild,\n} from 'services/onSite/interface';\n\nexport default function ProductVariantsPage() {\n\tconst [cards, setCards] = useState<IProductVariant | undefined>();\n\tconst [selectedCards, setSelectedCards] = useState<IProductVariantChild[]>(\n\t\t[]\n\t);\n\tconst { data, isLoading } = useGetProductVariants();\n\tconst { mutate, isPending } = useSetCardItems(setCards);\n\tconst [lastOfData , setLastOfData] = useState<IProductVariant | undefined>()\n\n\tuseEffect(() => {\n\t\tif (data) {\n\t\t\tsetCards(data);\n\t\t\tconst newSelected: IProductVariantChild[] = [];\n\t\t\tdata.items.map((item) => newSelected.push({ ...item, variants: [] }));\n\t\t\tsetSelectedCards(newSelected);\n\t\t}\n\t}, [data]);\n\n\tconst handleMutate = (\n\t\tbase_uuid: string,\n\t\tpayload: IProductVariantChildToChild,\n\t\tcount: number\n\t) => {\n\t\tconst newSelctedCard: IProductVariantChild[] = [];\n\t\tselectedCards.map((item) => {\n\t\t\tif (item.base_uuid === base_uuid) {\n\t\t\t\tconst findVariant = item.variants.find(\n\t\t\t\t\t(v) => v.variant_uuid === payload.variant_uuid\n\t\t\t\t);\n\t\t\t\tif (findVariant) {\n\t\t\t\t\tconst filterVariants = item.variants.filter(\n\t\t\t\t\t\t(v) => v.variant_uuid !== payload.variant_uuid\n\t\t\t\t\t);\n\t\t\t\t\tnewSelctedCard.push({\n\t\t\t\t\t\t...item,\n\t\t\t\t\t\tvariants: [...filterVariants, { ...payload, quantity: count }],\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tnewSelctedCard.push({\n\t\t\t\t\t\t...item,\n\t\t\t\t\t\tvariants: [...item.variants, { ...payload, quantity: count }],\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tnewSelctedCard.push(item);\n\t\t\t}\n\t\t});\n\t\tsetSelectedCards(newSelctedCard);\n\t\tif (cards) {\n\t\t\tconst newData: IProductVariant = {\n\t\t\t\ttotal_duration: cards?.total_duration,\n\t\t\t\ttotal_price: cards.total_price,\n\t\t\t\titems: newSelctedCard,\n\t\t\t};\n\t\t\tsetLastOfData(newData)\n\t\t\tmutate(newData);\n\t\t}\n\t};\n\n\tconst handleNewVariantMutate = (\n\t\tbase_uuid: string,\n\t\tpayload: number,\n\t\tsquareCount: number\n\t) => {\n\t\tconst newSelctedCard: IProductVariantChild[] = [];\n\t\tselectedCards.map((item) => {\n\t\t\tif (item.base_uuid === base_uuid) {\n\t\t\t\tconsole.log('item.new_variants', item);\n\t\t\t\tif (item.new_variants) {\n\t\t\t\t\tnewSelctedCard.push({\n\t\t\t\t\t\t...item,\n\t\t\t\t\t\tnew_variants: [\n\t\t\t\t\t\t\t...item.new_variants,\n\t\t\t\t\t\t\t{ variant_quantity: squareCount, quantity: payload },\n\t\t\t\t\t\t],\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tnewSelctedCard.push({\n\t\t\t\t\t\t...item,\n\t\t\t\t\t\tnew_variants: [\n\t\t\t\t\t\t\t{ variant_quantity: squareCount, quantity: payload },\n\t\t\t\t\t\t],\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tnewSelctedCard.push(item);\n\t\t\t}\n\t\t});\n\t\tsetSelectedCards(newSelctedCard);\n\t\tif (cards) {\n\t\t\tconst newData: IProductVariant = {\n\t\t\t\ttotal_duration: cards?.total_duration,\n\t\t\t\ttotal_price: cards.total_price,\n\t\t\t\titems: newSelctedCard,\n\t\t\t};\n\t\t\tsetLastOfData(newData)\n\t\t\tmutate(newData);\n\t\t}\n\t};\n\n\treturn (\n\t\t<>\n\t\t\t{isLoading ? (\n\t\t\t\t<Loading />\n\t\t\t) : (\n\t\t\t\t<>\n\t\t\t\t\t<div className=\"flex flex-col h-full min-h-screen\">\n\t\t\t\t\t\t<div className=\"flex-none w-full\">\n\t\t\t\t\t\t\t<Header title=\"خدمت در محل\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\" grow\">\n\t\t\t\t\t\t\t<div className=\"grid grid-cols-1 gap-4 items-center justify-center my-2 mx-2\">\n\t\t\t\t\t\t\t\t{cards &&\n\t\t\t\t\t\t\t\t\tcards.items.map((item) => (\n\t\t\t\t\t\t\t\t\t\t<CardItem\n\t\t\t\t\t\t\t\t\t\t\tkey={item.base_uuid}\n\t\t\t\t\t\t\t\t\t\t\titem={item}\n\t\t\t\t\t\t\t\t\t\t\thandleMutate={handleMutate}\n\t\t\t\t\t\t\t\t\t\t\thandleNewVariantMutate={handleNewVariantMutate}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{cards && cards.total_duration && cards.total_price && (\n\t\t\t\t\t\t\t<div className=\"flex-none\">\n\t\t\t\t\t\t\t\t<Footer time={cards.total_duration} price={cards.total_price} data = {lastOfData} mutate = {mutate} />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t</>\n\t\t\t)}\n\t\t</>\n\t);\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}